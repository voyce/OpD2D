This code was originally written a long time ago (2001!). You have been warned!
